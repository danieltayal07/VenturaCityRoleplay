<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="reset.css" rel="stylesheet" />
    <link href="style.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <title>Ventura City</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.1.3/axios.min.js"></script>
    <script src="vue.js"></script>
    <script src="swal2.js"></script>
</head>
<body>
    <div id="app">
        
        <transition name="fade">
            <div class="loading-screen" v-if="show.loading">
                <h2 style="color:var(--primary); font-family:'Rajdhani'; letter-spacing:5px;">{{loadingText}}</h2>
            </div>
        </transition>

        <transition name="fade">
            <div class="main-screen" v-if="show.characters">
                
                <div class="cinematic-toggle" @click="toggleCinematic">
                    <span class="material-symbols-outlined">{{ isCinematic ? 'visibility' : 'visibility_off' }}</span>
                    {{ isCinematic ? 'SHOW UI' : 'CINEMATIC' }}
                </div>

                <div class="ui-wrapper" :class="{ 'hidden-ui': isCinematic }">
                    
                    <div class="top-bar">
                        <div class="branding">
                            <h1>VENTURA <span>CITY</span> v0.2</h1>
                        </div>
                        <div class="server-status">
                            <div class="status-item"><i class="material-symbols-outlined">schedule</i> {{ currentTime }}</div>
                            <div class="status-item"><i class="material-symbols-outlined">cloud</i> {{ weather }}</div>
                            <div class="status-item"><i class="material-symbols-outlined">group</i> ID: {{ myId }}</div>
                        </div>
                    </div>

                    <div class="left-panel">
                        <div class="nav-tabs">
                            <div class="nav-tab" :class="{active: !showNews}" @click="showNews = false">CITIZENS</div>
                            <div class="nav-tab" :class="{active: showNews}" @click="showNews = true">NEWS</div>
                        </div>

                        <div class="char-list" v-if="!showNews">
                            <div v-for="index in characterAmount" :key="index" 
                                 class="char-card"
                                 :class="{'selected': selectedCharacter == index, 'create-card': !characters[index]}"
                                 @click="click_character(index, characters[index] ? 'existing' : 'empty')">
                                <template v-if="characters[index]">
                                    <div class="char-avatar"><span class="material-symbols-outlined">person</span></div>
                                    <div class="char-info">
                                        <h3>{{characters[index].charinfo.firstname}} {{characters[index].charinfo.lastname}}</h3>
                                        <p>{{characters[index].job.label}}</p>
                                    </div>
                                </template>
                                <template v-else>
                                    <div class="char-avatar"><span class="material-symbols-outlined">add</span></div>
                                    <div class="char-info"><h3>EMPTY SLOT</h3><p>Create Character</p></div>
                                </template>
                            </div>
                        </div>

                        <div class="news-content" v-if="showNews">
                            <div class="news-item">
                                <h3>Ventura v0.2 Live</h3>
                                <p>Welcome to the new city interface. Smoother transitions and better performance.</p>
                            </div>
                            <div class="news-item">
                                <h3>Community Event</h3>
                                <p>Whatev</p>
                            </div>
                            <div class="news-item">
                                <h3>System Update</h3>
                                <p>Gaand faad system</p>
                            </div>
                        </div>
                    </div>

                    <div class="right-panel">
                        
                        <div class="tool-row">
                            <div class="theme-picker">
                                <div class="theme-dot dot-gold" @click="setTheme('#FFD700')" :class="{active: currentTheme == '#FFD700'}"></div>
                                <div class="theme-dot dot-cyan" @click="setTheme('#00E5FF')" :class="{active: currentTheme == '#00E5FF'}"></div>
                                <div class="theme-dot dot-purple" @click="setTheme('#AA00FF')" :class="{active: currentTheme == '#AA00FF'}"></div>
                                <div class="theme-dot dot-crimson" @click="setTheme('#FF1744')" :class="{active: currentTheme == '#FF1744'}"></div>
                            </div>
                            <div class="cam-controls">
                                <div class="cam-btn" @click="changeCam('face')" title="Face Cam"><span class="material-symbols-outlined">face</span></div>
                                <div class="cam-btn" @click="changeCam('body')" title="Body Cam"><span class="material-symbols-outlined">accessibility_new</span></div>
                            </div>
                        </div>

                        <transition name="slide-up">
                            <div class="stats-card" v-if="selectedCharacter !== -1 && characters[selectedCharacter] && !showNews">
                                <div class="stat-header">
                                    <h2>{{characters[selectedCharacter].charinfo.firstname}} {{characters[selectedCharacter].charinfo.lastname}}</h2>
                                    <span>{{characters[selectedCharacter].charinfo.nationality}}</span>
                                </div>
                                <div class="stat-grid">
                                    <div class="stat-item"><label>DOB</label><span>{{characters[selectedCharacter].charinfo.birthdate}}</span></div>
                                    <div class="stat-item"><label>SEX</label><span>{{characters[selectedCharacter].charinfo.gender == 0 ? 'M' : 'F'}}</span></div>
                                    <div class="stat-item"><label>JOB</label><span>{{characters[selectedCharacter].job.label}}</span></div>
                                    <div class="stat-item"><label>BANK</label><span style="color:#4caf50">${{dollar.format(characters[selectedCharacter].money.bank)}}</span></div>
                                </div>
                                <button class="btn-play" @click="play_character">WAKE UP</button>
                                <div style="text-align:center; margin-top:10px;">
                                    <span v-if="allowDelete" style="color:var(--danger); cursor:pointer; font-size:0.8rem; font-weight:700;" @click="delete_character_modal">DELETE CHARACTER</span>
                                </div>
                            </div>
                        </transition>
                    </div>

                    <div class="bottom-bar">
                        <div class="news-box">
                            <span class="news-badge">UPDATE</span>
                            <span style="font-size:0.9rem;">Ventura City v0.2 is now live! Check Discord for changelog.</span>
                            <div class="socials">
                                <span class="social-btn" @click="openLink('https://discord.gg/Zu2TMggBmX')"><span class="material-symbols-outlined">discord</span></span>
                                <span class="social-btn" @click="openLink('https://nightcity25.netlify.app/')"><span class="material-symbols-outlined">shopping_cart</span></span>
                            </div>
                        </div>

                        <div class="music-bar">
                            <div class="visualizer" :class="{paused: !isPlaying}">
                                <div class="bar"></div><div class="bar"></div><div class="bar"></div>
                            </div>
                            <div class="music-info">
                                <span style="font-size:0.7rem; color:#888; font-weight:700;">NOW PLAYING</span><br>
                                <span style="font-family:'Rajdhani'; font-weight:700;">{{ currentSongName }}</span>
                            </div>
                            <div class="controls">
                                <button @click="toggleMusic"><span class="material-symbols-outlined">{{ isPlaying ? 'pause' : 'play_arrow' }}</span></button>
                                <button @click="nextSong"><span class="material-symbols-outlined">skip_next</span></button>
                            </div>
                        </div>
                    </div>
                </div> </div>
        </transition>

        <transition name="fade">
            <div class="register-overlay" v-if="show.register">
                <div class="reg-card">
                    <div class="reg-left">
                        <span class="material-symbols-outlined reg-icon">fingerprint</span>
                        <h2 style="color:white; margin:0;">IDENTITY</h2>
                        <p style="color:#666;">Create your official citizen record.</p>
                    </div>
                    <div class="reg-right">
                        <div class="input-row">
                            <input type="text" class="styled-input" v-model="registerData.firstname" placeholder="First Name">
                            <input type="text" class="styled-input" v-model="registerData.lastname" placeholder="Last Name">
                        </div>
                        <div class="input-row">
                            <select class="styled-input" v-model="registerData.gender">
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                            </select>
                            <input type="text" class="styled-input" v-model="registerData.nationality" placeholder="Nationality">
                        </div>
                        <div class="input-row">
                            <input type="date" class="styled-input" v-model="registerData.date">
                        </div>
                        
                        <div class="btn-biometric" @mousedown="startScan" @mouseup="stopScan" @mouseleave="stopScan">
                            <span class="material-symbols-outlined">fingerprint</span>
                            <span>{{ scanText }}</span>
                            <div class="scan-line" :style="{opacity: isScanning ? 1 : 0}"></div>
                        </div>
                        <div style="text-align:center; color:#444; font-size:0.8rem; margin-top:5px;">HOLD TO CONFIRM IDENTITY</div>
                        <button style="color:#666; margin-top:auto;" @click="cancelCreate">CANCEL</button>
                    </div>
                </div>
            </div>
        </transition>
    </div>

    <audio id="audio-player" src="sounds/music1.mp3" loop></audio>

    <script src="profanity.js"></script>
    <script src="validation.js"></script>
    <script src="translations.js"></script>
    <script src="app.js"></script>
</body>
</html>